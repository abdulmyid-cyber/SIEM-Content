title: Citrix NetScaler - Suspicious HTTP request with binary/non-printable payloads and 5xx response (CVE-2025-7775)
id: 5f9f1d4a-xxxx-4a2b-9a2b-xxxxxxxxxxxx
status: stable
description: Detects suspicious HTTP requests to NetScaler appliance (NetScaler/Citrix Server header) that contain binary/non-printable bytes or unusually large request bodies and are followed by server 5xx responses â€” indicative of memory overflow attempts (CVE-2025-7775). Tuned to reduce false positives by requiring NetScaler server header and server error response.
author: Abdul Rahman(abdulmyid@gmail.com
references:
  - 'https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX694938'
  - 'https://nvd.nist.gov/vuln/detail/CVE-2025-7775'
tags:
  - attack.exploitation
  - attack.initial_access
  - citrix
  - netscaler
  - cve-2025-7775
logsource:
  product: webserver
  service: http
  definition: 'HTTP access / reverse proxy / load balancer logs (WAF, proxy, load balancer, IDS HTTP logs). Requires fields: http.request.uri, http.request.body, http.response.status_code, http.response.headers.Server'
detection:
  selection_netcaler_server:
    http.response.headers.Server|contains: ['NetScaler', 'Citrix', 'Citrix NetScaler']
  # binary / non-printable bytes in URI or body (attempt payloads that include NULLs, control characters)
  suspicious_payload:
    - http.request.uri|matches: '.*[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F].*'
    - http.request.body|matches: '.*[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F].*'
  # unusually large body that can be used to trigger memory overflow (tunable threshold)
  large_body:
    http.request.headers.Content-Length|gt: 10000
  response_error:
    http.response.status_code: [500,502,503,504]
  condition: selection_netcaler_server and response_error and (suspicious_payload or large_body)
level: high
falsepositives:
  - Binary file uploads or legitimate non-ASCII application traffic proxied through a NetScaler (reduce by collecting full paths / known app whitelist)
  - Large file uploads (tune Content-Length threshold based on environment)
